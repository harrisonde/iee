/**!
 * @cidekar/window-rivet version 1.0.0
 * Copyright 2019 Cidekar, LLC
 * @license Released under the Apache-2.0 license.
 */
!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):t.rivet=i()}(this,function(){"use strict";var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)};function t(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}var a=(n.store={cache:{},hooks:{}},n.getConfiguration=function(t){return t?n.store.cache[t]:{}},n.listConfiguration=function(t){return void 0===t&&(t="cache"),n.store[t]},n.putConfiguration=function(t,i){void 0===t&&(t="cache"),Object.assign(n.store[t],i)},n);function n(){this.configuration={component:void 0,dispatcherOrigin:"*",receiverOrigin:"*",silent:!1,warningOrigin:!0},this.setConfiguration=function(t){try{return n.store.cache=Object.assign(n.store.cache,t),!0}catch(t){return t}},n.store.cache=this.configuration}function c(){a.getConfiguration("silent")}var r=(o.bind=function(){function i(t){}["created","mounted"].forEach(function(t){try{o.register(t,i)}catch(t){c()}})},o.boot=function(){o.bind(),o.call("created")},o.call=function(t,i){var n=a.listConfiguration("hooks")[t];void 0!==n&&(n.callback&&n.callback.apply(o,[i]),n.lifecycle=!0,n.lineage=n.lineage.concat(["ready"]))},o.register=function(t,i,n){var e;void 0===i&&(i=null),void 0===n&&(n="register");try{var r=a.listConfiguration("hooks")[t];if(void 0===r){var o=((e={})[t]={lifecycle:n,callback:i,lineage:[n]},e);a.putConfiguration("hooks",o)}else void 0!==r&&(r.callback=i,r.lifecycle=n,r.lineage=r.lineage.concat([n]))}catch(t){c()}},o.ready=function(){var t=!1,i=a.listConfiguration("hooks");return i&&i.created.lifecycle&&i.mounted.lifecycle&&(t=!0),t},o);function o(){}var i=(s.boot=function(t){var i=t?"dispatcher":"receiver";r.register(i,null,"boot"),r.register(i,function(t){})},s);function s(t){var e=this;this.supported_message_types=["string","object"],this.target=null,this.targetOrigin=null,this.warningOrigin=null,this.componentType=null,this.bind=function(){e.listen("message",e.handler)},this.listen=function(t,i){try{e.target.addEventListener(t,i)}catch(t){c()}},this.handler=function(t){if(e.trusted(t.origin)&&t.data)try{e.isSupported(t)&&r.ready()&&("*"===e.targetOrigin&&e.warningOrigin&&c(e.componentType),c(),e.emit(t.data.event,t.data))}catch(t){c()}},this.emit=function(t,i){try{var n=new Event(t);Object.assign(n,i),e.target.dispatchEvent(n)}catch(t){c()}},this.isSupported=function(t){for(var i=!1,n=0;n<e.supported_message_types.length;n++)if(e.supported_message_types[n]===typeof t.data){i=!0;break}return i},this.message=function(t,i){try{if(!t)throw new Error("attempt to dispatch without payload");if(!t.event)throw new Error("attempt to dispatch without defining an event");"*"===e.targetOrigin&&e.warningOrigin&&c(e.componentType),i?i.source.postMessage(t,i.origin):e.target.postMessage(t,e.targetOrigin)}catch(t){c()}},this.trusted=function(t){var i=!1,n=a.getConfiguration("dispatcherOrigin");if("string"==typeof n&&"*"===n&&(i=!0),"object"==typeof n)for(var e=0;e<n.length;e++)if(n[e]===t){i=!0;break}return i},this.componentType=t,this.warningOrigin=a.getConfiguration("warningOrigin"),"dispatcher"===t?(this.target=window.parent,this.targetOrigin=a.getConfiguration("receiverOrigin")):(this.target=window,this.targetOrigin=a.getConfiguration("dispatcherOrigin")),r.call(t),this.bind(t)}var g,u=(t(f,g=i),f);function f(){return g.call(this,"dispatcher")||this}var h,p,l=(t(d,h=i),d.boot=function(){i.boot("receiver")},d);function d(){var n=h.call(this,"receiver")||this;return n.handler=function(t){if(n.trusted(t.origin)&&t.data)try{n.isSupported(t)&&r.ready()&&("*"===n.targetOrigin&&n.warningOrigin&&c(n.componentType),c(),n.emit(t.data.event,t.data))}catch(t){c()}},n.message=function(t,i){try{if(!t)throw new Error("attempt to dispatch without payload");if(!t.event)throw new Error("attempt to dispatch without defining an event");"*"===n.targetOrigin&&n.warningOrigin&&c(n.componentType),i?i.source.postMessage(t,i.origin):n.target.postMessage(t,n.targetOrigin)}catch(t){c()}},n}function v(){var i=p.call(this)||this;return i.boot=function(t){i.setConfiguration(t),r.boot(),u.boot(),l.boot(),r.call("mounted")},i}var y=new(t(v,p=a),v);function O(t){y.boot(t),this.dispatcher=u,this.receiver=l}return O.version="1.0.0",O});
